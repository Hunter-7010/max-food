<%- include('../../partials/hopeNavbar') %>
  <%- include('../../partials/flash') %>

    <div class="card">
      <div class="card-body">
        <div class="container mb-5 mt-3">
          <div class="row d-flex align-items-baseline">
            <div class="col-xl-9">
              <p style="color: #7e8d9f;font-size: 20px;">Invoice >></p>
              <form action="/orders/<%=orders._id%>?_method=DELETE" method="POST">
                <button class="btn btn-danger mb-2" onclick="return confirm('Are you sure you want to delete this item?');">DELETE ORDER</button>
            </form>
            </div>
            <hr>
          </div>
          <form action="/orders/<%=orders._id%>?_method=PUT" class="needs-validation" method="post" novalidate>
            <div class="container">
              <div class="row">
                <div class="col-xl-3">
                  <ul class="list-unstyled">
                   
                        <li class="text-muted"><label for="clientName">Client Name:</label>  <div class="searchScreen">
                          <div class="searchInputBox">
                            <input type="text" class="searchInput form-control mb-2" id="clientName" name="clientName" value="<%=orders.clientName%>" readonly>
                              <div class="filterButton"></div>
                              <div class="queryBox">
                                  <div class="priceBox">
                                  </div>
                              </div>
                              <div class="searchRealButton"></div>
                              <div class="fakeBar"></div>
                          </div>
                          <ul class="autocompleteBox"></ul>
                      </div>
                    </li>
                    <li class="text-muted"><label for="address">Address:</label><input type="text"
                        class="form-control mb-2" id="address" name="clientAddress" value="<%=orders.clientAddress%>" readonly></li>
                  </ul>
                </div>
                <div class="col-6"></div>
                <div class="col-xl-3">
                  <div class="form-group">
                    <label class="form-label" for="exampleFormControlSelect1">Select Input</label>
                    <select class="form-select" id="exampleFormControlSelect1" name="route" required>
                    <option readonly id="selectRoute" selected value="<%=orders.route%>"><%=orders.route%></option>
                       <option value="" disabled>Please select</option><option value="AUGUSTOW">AUGUSTOW</option><option value="AUGUSTOW 2">AUGUSTOW 2</option><option value="BIALYSTOK">BIALYSTOK</option><option value="Bialystok 2">Bialystok 2</option><option value="CENTRUM">CENTRUM</option><option value="Elblag">Elblag</option><option value="GDANSK">GDANSK</option><option value="GIZYCKO">GIZYCKO</option><option value="Goldap">Goldap</option><option value="Grajewo">Grajewo</option><option value="Hajnówka">Hajnówka</option><option value="HRUBIESZOW">HRUBIESZOW</option><option value="KATOWICE">KATOWICE</option><option value="KETRZYN">KETRZYN</option><option value="KOLNO">KOLNO</option><option value="Kozle">Kozle</option><option value="Krakow">Krakow</option><option value="KUTNO">KUTNO</option><option value="Kutno 2">Kutno 2</option><option value="KWIDZYN">KWIDZYN</option><option value="Lebork">Lebork</option><option value="Legnica">Legnica</option><option value="LIPNO">LIPNO</option><option value="LODZ">LODZ</option><option value="Lubań">Lubań</option><option value="Lubartów">Lubartów</option><option value="lubelskim">lubelskim</option><option value="Lublin">Lublin</option><option value="MAGAZYN">MAGAZYN</option><option value="Mragowo">Mragowo</option><option value="MSZCZONOW">MSZCZONOW</option><option value="Nowa Sól">Nowa Sól</option><option value="Okonek">Okonek</option><option value="OLSZTYN">OLSZTYN</option><option value="Olsztyn 2">Olsztyn 2</option><option value="Oława">Oława</option><option value="OPOCZNO">OPOCZNO</option><option value="OSTRODA">OSTRODA</option><option value="OSTRODA 2">OSTRODA 2</option><option value="OSTROLEKA">OSTROLEKA</option><option value="PLOCK">PLOCK</option><option value="POZNAN">POZNAN</option><option value="PRZASNYCZ">PRZASNYCZ</option><option value="Raciborz">Raciborz</option><option value="RYBNIK">RYBNIK</option><option value="SANDOMIERZ">SANDOMIERZ</option><option value="Siedlec">Siedlec</option><option value="Śląski">Śląski</option><option value="Sochaczew">Sochaczew</option><option value="sokolka 2">sokolka 2</option><option value="Sokółka">Sokółka</option><option value="Suwałki">Suwałki</option><option value="SZCZECIN">SZCZECIN</option><option value="TRASA ZIELONA GORA">TRASA ZIELONA GORA</option><option value="Wałbrzych">Wałbrzych</option><option value="Warsaw">Warsaw</option><option value="Wegorzewo">Wegorzewo</option><option value="Wlodawa">Wlodawa</option><option value="Wroclaw">Wroclaw</option><option value="Zakroczym">Zakroczym</option><option value="Zawiercie">Zawiercie</option><option value="Zgorzelec">Zgorzelec</option><option value="ZIELONA GORA">ZIELONA GORA</option>
                    </select>
                </div>
                  <div class="form-group">
                    <label class="form-label" for="date">Date Input</label> 
                    <input type="date" class="form-control" id="date" name="date" value="<%=orders.date.toISOString().substring(0,10)%>" required>
                </div>
                  <ul class="list-unstyled">
                    <li class="text-muted"> <input type="hidden" id="customerId" name="customerId" value="<%=orders.customerId%>">
                    </li>

                    <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                        class="fw-bold">Creation Date: </span><%=orders.createdAt%> </li>
                    <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                        class="me-1 fw-bold">Status:</span><span class="badge bg-warning text-black fw-bold">
                        Unpaid</span></li>
                  </ul>
                </div>
              </div>
              <div class="container border" id="itemsContainer">
                  <%for(let i = 0; i <orders.items.length; i++) {%>

                <div class="row my-2 mx-1">
                  
                  <div class="col-4"><label for="item">Name:</label>
                    <div class="searchScreen">
                      <div class="searchInputBox">
                        <input type="text" class="searchInput form-control" name="<%=i+1%>[name]" value="<%=orders.items[i].name%>"/>
                        <div class="searchRealButton"></div>
                        <div class="fakeBar"></div>
                      </div>
                      <ul class="autocompleteBox"></ul>
                    </div>
                  </div>
                  <div class="col-2"><label for="quantity">quantity:</label><input class="form-control"
                      id="quantity" name="<%=i+1%>[quantity]" value="<%=orders.items[i].quantity%>" type="number"></div>
                  <div class="col-1"><label for="amount">Amount:</label><input class="form-control"
                      id="amount" name="<%=i+1%>[amount]" type="number" value="<%=orders.items[i].amount%>" readonly></div>
                  <div class="col-2"><label for="price">Price:</label><input class="form-control"
                      id="price" name="<%=i+1%>[price]" type="number" value="<%=orders.items[i].price%>" step=".01"></div>
                  <div class="col-2"><label for="total">Total:</label><input class="totalA form-control"
                      id="total" name="<%=i+1%>[total]" value="<%if(orders.items[i].amount){ %><%=orders.items[i].quantity*orders.items[i].amount*orders.items[i].price%><% }else{ %><%=orders.items[i].quantity*orders.items[i].price%><% }%>">
                    </div>
                    <input type="hidden" name="<%=i+1%>[id]" value="<%=orders.items[i].id%>">
                      <div class="col-1">
                        <label for=""></label>
                        <button class="btn btn-danger deleteButton" type="button">DELETE</button>
                       </div>
                      
                </div> 
               
                <% } %>
           
              </div>
              
              <button id="addNewItem" class="btn btn-primary mt-2" type="button" style="position:static">Add item</button>

              <div class="row">
                <div class="col-xl-8">
                  <label class="form-label" for="exampleFormControlTextarea1">Notes:</label>
                  <textarea class="form-control" id="exampleFormControlTextarea1" name="notes" rows="5" value="<%=orders.notes%>"></textarea>

                </div>
                <div class="col-xl-3">
                 
                  <p class="text-black float-start"><span class="text-black me-3"> Total Amount</span><span
                      style="font-size: 25px;"  id="totalAmount">0 PLN</span></p>
                      <input type="hidden" id="totalAmountAll" name="totalAmountAll">
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-xl-10">
                  
                </div>
                <div class="col-xl-2">
                  <button type="submit" class="btn btn-primary text-capitalize" id="saveButton">Edit</button>
                </div>
              </div>
          </form>

        </div>
      </div>
    </div>
    </div>
    <script src="/js/Corporate/saveA.js"></script>
    <script src="/js/Corporate/addItem.js"></script>
    <script src="/js/Corporate/MitemSearch.js"></script>
    


    <%- include('../../partials/hopeFooter') %>